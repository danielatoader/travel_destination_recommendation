<html>
  <head>
    <title>Travel Recommendation</title>
    <script type="text/javascript" src="brython.js"></script>
    <script type="text/javascript" src="brython_stdlib.js"></script>
  <link rel="icon" href="data:;base64,=">
  </head>
  <body onload="brython(1)">
    <script type="text/python3">
      from browser import document, ajax
      import json
      import warnings
 
      def get_random_cities(response):
          if response.status==200 or response.status==0:
              cities = json.loads(response.text)
              change_place_names(cities)
          else:
              warnings.warn(response.text)
              
      def get_user_scores(ev):
          """Get the predicted probability."""
          req = ajax.ajax()
          req.bind('complete', get_random_cities)
          req.open('POST', '/scores', False)
          req.set_header('content-type','application/json')
          user_inputs = {
              'user_input_forest': document['forest_slider'].value,
              'user_input_castle': document['castle_slider'].value,
              'user_input_water': document['water_slider'].value,
              'user_input_historical': document['historical_slider'].value,
              'user_input_urban': document['urban_slider'].value
            }
          data = json.dumps(user_inputs)
          req.send(data)
      
      def change_place_names(cities):
          for k, v in cities.items():
              place = repr(v)
              city_country = place.replace("'", "").replace("[", "").replace("]", "")
              city = place.split(",")[0].replace(" ", "_").lower().replace("[", "").replace("'", "")
              document[f"place_{int(k)+1}"].textContent = city_country
              document[f"place_{int(k)+1}_img"].attrs["src"] = f"images/{city}.jpg"
              
      def show_random_places(ev):
         document["random_recs"].style.display = "inline"
      
      def show_recommendations(ev):
         document["final_recs"].style.display = "inline"
      
      def get_recs(response):
          if response.status==200 or response.status==0:
              recommendations = json.loads(response.text)
              clean_recommendations(recommendations)     
          else:
              warnings.warn(response.text)
              
      def get_recommendations(ev):
          """Get the predicted probability."""
          req = ajax.ajax()
          req.bind('complete', get_recs)
          req.open('POST', '/recommend', True)
          req.set_header('content-type','application/json')
          user_inputs = {
              'user_input_place_1': document['place_1_slider'].value,
              'user_input_place_2': document['place_2_slider'].value,
              'user_input_place_3': document['place_3_slider'].value,
              'user_input_place_4': document['place_4_slider'].value,
              'user_input_place_5': document['place_5_slider'].value,
              'user_input_place_6': document['place_6_slider'].value,
              'user_input_place_7': document['place_7_slider'].value,
              'user_input_place_8': document['place_8_slider'].value,
              'user_input_place_9': document['place_9_slider'].value,
              'user_input_place_10': document['place_10_slider'].value
            }
          data = json.dumps(user_inputs)
          req.send(data)
      
      def clean_recommendations(recommendations):
          for k, v in recommendations.items():
              place = repr(v)
              city_country = place.replace("'", "").replace("[", "").replace("]", "")
              city = place.split(",")[0].replace(" ", "_").lower().replace("[", "").replace("'", "")
              document[f"rec_{int(k)+1}"].textContent = city_country
              document[f"rec_{int(k)+1}_img"].attrs["src"] = f"images/{city}.jpg"

      def get_sats(response):
          if response.status==200 or response.status==0:
              pass   
          else:
              warnings.warn(response.text)
              
      def get_satisfaction(ev):
          """Get the predicted probability."""
          req = ajax.ajax()
          req.bind('complete', get_sats)
          req.open('POST', '/rate_recs', True)
          req.set_header('content-type','application/json')
          user_inputs = {
              'rec_1_interest': document['rec_1_interest'].value,
              'rec_2_interest': document['rec_2_interest'].value,
              'rec_3_interest': document['rec_3_interest'].value,
              'rec_4_interest': document['rec_4_interest'].value,
              'rec_5_interest': document['rec_5_interest'].value
            }
          data = json.dumps(user_inputs)
          print(data)
          req.send(data)
          
      document["score_button"].bind("click", get_user_scores, show_random_places)
      document["city_rating_button"].bind("click", get_recommendations, show_recommendations)
      document["satisfaction_button"].bind("click", get_satisfaction)
            
      def update_forest_slider_label(ev):
             forest_slide_val = document["forest_slider"].value
             document["forest_label"].textContent = forest_slide_val
      
      def update_castle_slider_label(ev):
             castle_slide_val = document["castle_slider"].value
             document["castle_label"].textContent = castle_slide_val
      
      def update_water_slider_label(ev):
             water_slide_val = document["water_slider"].value
             document["water_label"].textContent = water_slide_val
      
      def update_historical_slider_label(ev):
             historical_slide_val = document["historical_slider"].value
             document["historical_label"].textContent = historical_slide_val
      
      def update_urban_slider_label(ev):
             urban_slide_val = document["urban_slider"].value
             document["urban_label"].textContent = urban_slide_val
      
      def update_place_1_label(ev):
             place_1_val = document["place_1_slider"].value
             if place_1_val == "-1":
                 document["place_1_label"].textContent = "Have been and disliked"
             elif place_1_val == "1":
                 document["place_1_label"].textContent = "Have been and liked"
             else:
                 document["place_1_label"].textContent = "Have not been"
      
      def update_place_2_label(ev):
             place_2_val = document["place_2_slider"].value
             if place_2_val == "-1":
                 document["place_2_label"].textContent = "Have been and disliked"
             elif place_2_val == "1":
                 document["place_2_label"].textContent = "Have been and liked"
             else:
                 document["place_2_label"].textContent = "Have not been"
      
      def update_place_3_label(ev):
             place_3_val = document["place_3_slider"].value
             if place_3_val == "-1":
                 document["place_3_label"].textContent = "Have been and disliked"
             elif place_3_val == "1":
                 document["place_3_label"].textContent = "Have been and liked"
             else:
                 document["place_3_label"].textContent = "Have not been"                 
      
      def update_place_4_label(ev):
             place_4_val = document["place_4_slider"].value
             if place_4_val == "-1":
                 document["place_4_label"].textContent = "Have been and disliked"
             elif place_4_val == "1":
                 document["place_4_label"].textContent = "Have been and liked"
             else:
                 document["place_4_label"].textContent = "Have not been"     
      
      def update_place_5_label(ev):
             place_5_val = document["place_5_slider"].value
             if place_5_val == "-1":
                 document["place_5_label"].textContent = "Have been and disliked"
             elif place_5_val == "1":
                 document["place_5_label"].textContent = "Have been and liked"
             else:
                 document["place_5_label"].textContent = "Have not been"
      
      def update_place_6_label(ev):
             place_6_val = document["place_6_slider"].value
             if place_6_val == "-1":
                 document["place_6_label"].textContent = "Have been and disliked"
             elif place_6_val == "1":
                 document["place_6_label"].textContent = "Have been and liked"
             else:
                 document["place_6_label"].textContent = "Have not been"                 
      
      def update_place_7_label(ev):
             place_7_val = document["place_7_slider"].value
             if place_7_val == "-1":
                 document["place_7_label"].textContent = "Have been and disliked"
             elif place_7_val == "1":
                 document["place_7_label"].textContent = "Have been and liked"
             else:
                 document["place_7_label"].textContent = "Have not been"                 
      
      def update_place_8_label(ev):
             place_8_val = document["place_8_slider"].value
             if place_8_val == "-1":
                 document["place_8_label"].textContent = "Have been and disliked"
             elif place_8_val == "1":
                 document["place_8_label"].textContent = "Have been and liked"
             else:
                 document["place_8_label"].textContent = "Have not been"                 
      
      def update_place_9_label(ev):
             place_9_val = document["place_9_slider"].value
             if place_9_val == "-1":
                 document["place_9_label"].textContent = "Have been and disliked"
             elif place_9_val == "1":
                 document["place_9_label"].textContent = "Have been and liked"
             else:
                 document["place_9_label"].textContent = "Have not been"                 
      
      def update_place_10_label(ev):
             place_10_val = document["place_10_slider"].value
             if place_10_val == "-1":
                 document["place_10_label"].textContent = "Have been and disliked"
             elif place_10_val == "1":
                 document["place_10_label"].textContent = "Have been and liked"
             else:
                 document["place_10_label"].textContent = "Have not been"                 
                 
                 
      document["forest_slider"].bind("change", update_forest_slider_label)
      document["castle_slider"].bind("change", update_castle_slider_label)
      document["water_slider"].bind("change", update_water_slider_label)
      document["historical_slider"].bind("change", update_historical_slider_label)
      document["urban_slider"].bind("change", update_urban_slider_label)

      document["place_1_slider"].bind("change", update_place_1_label)
      document["place_2_slider"].bind("change", update_place_2_label)
      document["place_3_slider"].bind("change", update_place_3_label)
      document["place_4_slider"].bind("change", update_place_4_label)
      document["place_5_slider"].bind("change", update_place_5_label)
      document["place_6_slider"].bind("change", update_place_6_label)
      document["place_7_slider"].bind("change", update_place_7_label)
      document["place_8_slider"].bind("change", update_place_8_label)
      document["place_9_slider"].bind("change", update_place_9_label)
      document["place_10_slider"].bind("change", update_place_10_label)

     
    </script>
    <h1>Rate importance on a scale of 0 to 10</h1>  
    
    <div>Forest/Mountain</div>
    <div>
        <img src="images/forest_mountain.jpg" width="100" height="80">
    </div>
    <div class="slidecontainer">
        <input type="range" min="0" max="10" step="1" value="5" id="forest_slider" class="slider"/>
        <span id="forest_label">5</span>
    </div>
    <div>Palaces/Castles</div>
    <div>
        <img src="images/palace_castle.jpg" width="100" height="80">
    </div>
    <div class="slidecontainer">
      <input type="range" min="0" max="10" value="5" class="slider" id="castle_slider">
      <span id="castle_label">5</span>
    </div>
    <div>Coastal/Water</div>
    <div>
        <img src="images/coastal.jpg" width="100" height="80">
    </div>
    <div class="slidecontainer">
      <input type="range" min="0" max="10" value="5" class="slider" id="water_slider">
      <span id="water_label">5</span>
    </div>
    <div>Historical</div>
    <div>
        <img src="images/historical.jpg" width="100" height="80">
    </div>
    <div class="slidecontainer">
      <input type="range" min="0" max="10" value="5" class="slider" id="historical_slider">
      <span id="historical_label">5</span>
    </div>
    <div>Urban</div>
    <div>
        <img src="images/urban.jpg" width="100" height="80">
    </div>
    <div class="slidecontainer">
      <input type="range" min="0" max="10" value="5" class="slider" id="urban_slider">
      <span id="urban_label">5</span>
    </div>
    <button id="score_button">Submit</button>
      
     
    <div id="random_recs" style="display:none">   
        <h2>Slide right if you have been to the location and liked it. Slide left if you have been to the location and did not like it. Do nothing if you have not been to the location.</h2>
        
        <div id=place_1>place 1</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=place_1_img>
        </div>
        <div class="slidecontainer">
            <input type="range" min="-1" max="1" value="0" class="slider" id="place_1_slider">
            <span id="place_1_label">Have not been</span>
        </div>  
        
        <div id=place_2>place 2</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=place_2_img>
        </div>
        <div class="slidecontainer">
            <input type="range" min="-1" max="1" value="0" class="slider" id="place_2_slider">
            <span id="place_2_label">Have not been</span>
        </div> 
        
        <div id=place_3>place 3</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=place_3_img>
        </div>
        <div class="slidecontainer">
            <input type="range" min="-1" max="1" value="0" class="slider" id="place_3_slider">
            <span id="place_3_label">Have not been</span>
        </div>
        
        <div id=place_4>place 4</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=place_4_img>
        </div>
        <div class="slidecontainer">
            <input type="range" min="-1" max="1" value="0" class="slider" id="place_4_slider">
            <span id="place_4_label">Have not been</span>
        </div>
        
        <div id=place_5>place 5</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=place_5_img>
        </div>
        <div class="slidecontainer">
            <input type="range" min="-1" max="1" value="0" class="slider" id="place_5_slider">
            <span id="place_5_label">Have not been</span>
        </div>
        <div id=place_6>place 6</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=place_6_img>
        </div>
        <div class="slidecontainer">
            <input type="range" min="-1" max="1" value="0" class="slider" id="place_6_slider">
            <span id="place_6_label">Have not been</span>
        </div>
        <div id=place_7>place 7</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=place_7_img>
        </div>
        <div class="slidecontainer">
            <input type="range" min="-1" max="1" value="0" class="slider" id="place_7_slider">
            <span id="place_7_label">Have not been</span>
        </div>
        <div id=place_8>place 8</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=place_8_img>
        </div>
        <div class="slidecontainer">
            <input type="range" min="-1" max="1" value="0" class="slider" id="place_8_slider">
            <span id="place_8_label">Have not been</span>
        </div>
        <div id=place_9>place 9</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=place_9_img>
        </div>
        <div class="slidecontainer">
            <input type="range" min="-1" max="1" value="0" class="slider" id="place_9_slider">
            <span id="place_9_label">Have not been</span>
        </div>
        <div id=place_10>place 10</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=place_10_img>
        </div>
        <div class="slidecontainer">
            <input type="range" min="-1" max="1" value="0" class="slider" id="place_10_slider">
            <span id="place_10_label">Have not been</span>
        </div>
        <button id="city_rating_button">Find Top 5 Destinations</button>
     </div>
     
           
      <div id="final_recs" style="display:none"> 
        <form id=interest_questions>
        
        <h2>Here are your recommendations! Let us know if you are interested in the destinations</h2>
        <div id=rec_1>rec 1</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=rec_1_img>
        </div>
            
        <input type="image" src="images/thumbs_up.png" width="50" height="50" id="thumbs_up"/>
        <input type="image" src="images/thumbs_down.png" width="50" height="50" id="thumbs_down"/>    
<!--       
        <input type="radio" name="choice" value="1"> Interested!
        <input type="radio" name="choice" value="0"> Not interested
         -->
            
        <div id=rec_2>rec 2</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=rec_2_img>
        </div>
        
        <input type="radio" name="choice" value="1"> Interested!
        <input type="radio" name="choice" value="0"> Not interested
            
        <div id=rec_3>rec 3</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=rec_3_img>
        </div>
            
        <input type="radio" name="choice" value="1"> Interested!
        <input type="radio" name="choice" value="0"> Not interested
            
        <div id=rec_4>rec 4</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=rec_4_img>
        </div>
            
        <input type="radio" name="choice" value="1"> Interested!
        <input type="radio" name="choice" value="0"> Not interested
        
        <div id=rec_5>rec 5</div>
        <div>
            <img src="images/historical.jpg" width="100" height="80" id=rec_5_img>
        </div>
        
        <input type="radio" name="choice" value="1"> Interested!
        <input type="radio" name="choice" value="0"> Not interested
            
        <button id="satisfaction_button">Thank you!</button>
        </form> 
     </div>
  </body>
</html>




